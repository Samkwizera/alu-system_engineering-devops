#!/usr/bin/env bash
# Script to configure Nginx with a custom HTTP response header X-Served-By

set -e  # Exit immediately if a command exits with a non-zero status

# Update packages and install Nginx
sudo apt-get update -y
sudo apt-get install -y nginx

# Ensure Nginx is running without systemctl
sudo service nginx start || sudo /etc/init.d/nginx start

# Get the current hostname
HOSTNAME=$(hostname)

# Configure Nginx to include custom header
sudo sed -i "/server_name _;/a \\n    add_header X-Served-By $HOSTNAME;" /etc/nginx/sites-available/default

# Restart Nginx without systemctl
sudo service nginx restart || { sudo killall -q nginx && sudo nginx; }

echo "1"

